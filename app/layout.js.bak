
// // import "./globals.css";
// // import Navbar from "./Components/Navbar";
// // import Sessionwrapper from "./Components/Sessionwrapper";





// // export const metadata = {
// //   title: "Create Next App",
// //   description: "Generated by create next app",
// // };

// // export default function RootLayout({ children }) {
// //   return (
// //     <html lang="en">
// //       <body
        
// //       ><Sessionwrapper>
// //        <Navbar/>

// //         {children}
// //         </Sessionwrapper>
// //       </body>
// //     </html>
// //   );
// // }

// // "use client"

// // import "./globals.css";
// // // import Navbar from "./Components/Navbar";
// // // import Sessionwrapper from "./Components/Sessionwrapper";
// // import { useEffect } from "react";
// // // import { useSession } from "next-auth/react";
// // import { useRouter } from "next/navigation";

// // // Small client-side wrapper to handle redirects
// // function AuthRedirectWrapper({ children }) {
// //   // const { data: session, status } = useSession();
// //   const router = useRouter();

// //   useEffect(() => {
// //     if (status === "loading") return;
// //     if (session?.user?.mustChangePassword) {
// //       router.push("/reset-password");
// //     }
// //   }, [session, status, router]);

// //   return children;
// // }

// // // export const metadata = {
// // //   title: "Create Next App",
// // //   description: "Generated by create next app",
// // // };

// // export default function RootLayout({ children }) {
// //   return (
// //     <html lang="en">
// //       <body>
// // {/*       
// //           <Navbar /> */}
// //           {/* Wrap all pages with AuthRedirectWrapper */}
// //           {/* <AuthRedirectWrapper>
           
// //           </AuthRedirectWrapper> */}
// //            {children}
       
// //       </body>
// //     </html>
// //   );
// // }


// //  import "./globals.css";
// // import { VRTourProvider } from "@/context/VRTourContext";
// // import Sessionwrapper from "./Sessionwrapper";


// // export default function RootLayout({ children }) {
// //   return (
// //     <html lang="en">
// //       <body>
// //         <Sessionwrapper>
     
// //         <VRTourProvider>{children}</VRTourProvider></Sessionwrapper>
// //       </body>
// //     </html>
// //   );
// // }
// // app/layout.js
// import "./globals.css";
// import Sessionwrapper from "./Sessionwrapper";
// // import VRTourProvider from "@/context/VRTourContext";
// import { VRTourProvider } from "@/context/VRTourContext";
// import { getServerSession } from "next-auth";
// import Navbar from "./components/Navbar";

// export default async function RootLayout({ children }) {
//   // fetch session on server so pages can be server-protected and avoid flicker
//   const session = await getServerSession(Sessionwrapper);

//   return (
//     <html lang="en">
//       <body>
//         <Sessionwrapper serverSession={session}>
    
//           <VRTourProvider>
//                 <Navbar/>
//             {children}</VRTourProvider>
//         </Sessionwrapper>
//       </body>
//     </html>
//   );
// }

// app/layout.js (server component)
import "./globals.css";
import Sessionwrapper from "./Sessionwrapper";
import { VRTourProvider } from "@/context/VRTourContext";
import { getServerSession } from "next-auth";
import { authOptionsBase } from "@/lib/authOptions";
import Navbar from "./components/Navbar";

export default async function RootLayout({ children }) {
  const session = await getServerSession(authOptionsBase);

  return (
    <html lang="en">
      <body>
        <Sessionwrapper serverSession={session}>
          <VRTourProvider>
            <Navbar />
            {children}
          </VRTourProvider>
        </Sessionwrapper>
      </body>
    </html>
  );
}
